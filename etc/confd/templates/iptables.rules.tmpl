# Generated by iptables-save v1.4.12 on Sat Jan 12 00:33:11 2013
*raw
:PREROUTING ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
COMMIT
# Completed on Sat Jan 12 00:33:11 2013
# Generated by iptables-save v1.4.18 on Mon Nov 25 01:52:43 2013
*mangle
:PREROUTING ACCEPT [0:0]
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
:POSTROUTING ACCEPT [0:0]
COMMIT
# Completed on Mon Nov 25 01:52:43 2013
# Generated by iptables-save v1.4.12 on Sat Jan 12 00:33:11 2013
*nat
:PREROUTING ACCEPT [0:0]
:INPUT ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
:POSTROUTING ACCEPT [0:0]
COMMIT
# Completed on Sat Jan 12 00:33:11 2013
# Generated by iptables-save v1.4.12 on Sat Jan 12 00:33:11 2013
*filter
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
-A INPUT -i lo -j ACCEPT
-A INPUT -m state --state INVALID -j DROP
-A INPUT -d 172.17.0.0/16 -j ACCEPT
-A INPUT -p tcp -m tcp ! --tcp-flags FIN,SYN,RST,ACK SYN -m state --state NEW -j DROP
-A INPUT -p tcp -m state --state NEW -i tun0 -m tcp --dport 9000:9001 -m comment --comment rtorrent -j ACCEPT
-A INPUT -p tcp -m state --state NEW -i tun0 -m tcp --dport 6881 -m comment --comment rtorrent-dht -j ACCEPT
-A INPUT -p icmp -m icmp --icmp-type 8 -m hashlimit --hashlimit-upto 3/sec --hashlimit-burst 5 --hashlimit-mode srcip --hashlimit-name icmp --hashlimit-htable-expire 1 -m state --state NEW -j ACCEPT
-A INPUT -j DROP
-A OUTPUT -o tun0 -j ACCEPT -m comment --comment "unencrypted traffic inside tunnel"
-A OUTPUT -d {{ getv "/openvpn/server" }}/32 -p udp -m udp --dport 1194 -m comment --comment "encrypted traffic" -j ACCEPT
-A OUTPUT -d 172.17.0.0/16 -j ACCEPT
-A OUTPUT -o lo -j ACCEPT
-A OUTPUT -j DROP
COMMIT
# Completed on Sat Jan 12 00:33:11 2013
